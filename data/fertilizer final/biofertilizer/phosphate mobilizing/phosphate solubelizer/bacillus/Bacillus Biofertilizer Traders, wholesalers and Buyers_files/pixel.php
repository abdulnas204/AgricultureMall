var pixel={pixelConfig:null,initialize:null,finalize:null,paramArray:[],pageLoadStatusFlag:false,checkReadyStateOnIntervals:null,pixelFireStatus:false,tyPage:false,parse:function(b){if(b){pixel.pixelFireStatus=false;pixel.tyPage=true;}try{if(!pixel.pixelFireStatus){pixel.checkReadyStateOnIntervals=setInterval(function(){try{pixel.checkIfPageLoadComplete();if(pixel.pageLoadStatusFlag&&!pixel.pixelFireStatus){pixel.initialize();pixel.getParams();pixel.finalize();}}catch(c){pixel.paramArray.param="999";pixel.paramArray.err=c;pixel.fireAnalyze(pixel.getQueryString(pixel.paramArray));}},3000,"Javascript");}}catch(a){pixel.paramArray.param="999";pixel.paramArray.err=a;pixel.fireAnalyze(pixel.getQueryString(pixel.paramArray));}},checkIfPageLoadComplete:function(){if(document.readyState==="interactive"||document.readyState==="complete"){pixel.pageLoadStatusFlag=true;clearInterval(pixel.checkReadyStateOnIntervals);}else{pixel.pageLoadStatusFlag=false;}},getParams:function(){var b="",a="",c="";for(var d in pixel.pixelConfig){if(pixel.pixelConfig.hasOwnProperty(d)&&pixel.pixelConfig[d]){b=pixel.pixelConfig[d][1];a=pixel.pixelConfig[d][0];c=pixel.pixelConfig[d][2];if(b){if(b==="xpath"&&a){pixel.paramArray[d]=pixel.getDataFromXPath(a,c);}else{if(b==="url"&&a&&c){pixel.paramArray[d]=pixel.getDataFromUrl(a,c);}}}}}},getDataFromXPath:function(j,k){var r=[],f=[],b=[];var h="",e,d="";var q="",p="";var g=0;var c=document.getElementsByTagName("body")[0];var a=true;e=j.replace("/html/body/","");if(j.indexOf('@id="')!==-1){r=j.match(/.*\[@id="(.+)"\].*/);if(typeof r!=="undefined"&&r!==null&&r.length>=1){h=r[1];}}if(h){c=document.getElementById(h);var o='/*[@id="'+h+'"]/';var n='//*[@id="'+h+'"]/';var l='//*[@id="'+h+'"]';var m='*//*[@id="'+h+'"]/';e=e.replace(m,"");e=e.replace(n,"");e=e.replace(o,"");e=e.replace(l,"");}if(!e){c=document.getElementById(h);}else{f=e.split("/");for(g=0;g<f.length;g++){if(f[g]){b=f[g].match(/(\w*)(\[(\d+)\])?/);if(b){q=b[1];p=1;if(b[3]){p=b[3];}}}if(c&&c!="No Data"){c=pixel.getCurrentNode(c,q,p);}else{a=false;break;}}}if(c&&a&&c!="No Data"){if(!k){if(c.innerHTML){d=c.innerHTML;}}else{if(c.getAttribute(k)){d=c.getAttribute(k);}}return pixel.removeJunk(d);}else{return"";}},removeJunk:function(a){if(a){a=a.toString();a=a.replace(/(^\s*)|(\s*$)/gi,"");a=a.replace(/[ ]{2,}/gi," ");a=a.replace(/\n /,"\n");a=a.replace(/<.*?>/g,"");a=a.replace(/[ \t\r\n]+/g," ");a=a.replace(/^\s+|\s+$/g,"");a=a.replace(/&amp;/g,"&");return a;}return"";},getCurrentNode:function(e,c,f){var b="No Data";var a=1,d=0;if(e.childNodes){var g=e.childNodes;for(a=0;a<g.length;a++){if(g[a]&&g[a].tagName&&g[a].tagName.toLowerCase()===c){d++;}if(d==f){b=g[a];break;}}return b;}else{return null;}},getDataFromUrl:function(d,c){var b,a=document.URL;c=parseInt(c);b=a.match(d);if(b&&b[c]){if(c>=0){return b[c];}else{c=Math.abs(c);return b[b.length-c];}}return"";},fireAnalyze:function(d){clearInterval(pixel.checkReadyStateOnIntervals);if(!(pixel.pixelFireStatus)){var b=document.location.protocol+"//sg-pl.vizury.com/analyze/analyze.php";var c=document.createElement("iframe");c.src=b+d;c.scrolling="no";c.width=1;c.height=1;c.marginheight=0;c.marginwidth=0;c.frameborder=0;c.style.display="none";pixel.pixelFireStatus=true;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(c,a);}},paramChange:function(a){if(a){a=a.toString();a=a.replace(/<.*?>/g,"");a=a.replace(/[ \t\r\n]+/g," ");a=a.replace(/^\s+|\s+$/g,"");a=a.replace(/&amp;/g,"&");a=encodeURIComponent(encodeURIComponent(a));return a;}return"";},getQueryString:function(a){var c=a.account_id;var e="?account_id="+c;delete a.account_id;var d="";for(var b in a){if(a.hasOwnProperty(b)){d=a[b];e+="&"+b+"="+pixel.paramChange(d);}}return e;},set2DayCookie:function(a,h,c,e){var i=".indiamart.com";var d=i?("; domain="+i):"";var f;if(c!==-1){var g=new Date();if(e){var b=new Date(parseInt(h.split("|")[1]));f=encodeURIComponent(h)+((b==null)?"":"; expires="+b.toUTCString())+"; path=/"+d;}else{g.setDate(g.getDate()+c);h=h+"|"+g.getTime();f=encodeURIComponent(h)+((g==null)?"":"; expires="+g.toUTCString())+"; path=/"+d;}}else{f=encodeURIComponent(h);}document.cookie=a+"="+f;},getCookieValue:function(c){var d=document.cookie;if(d.length>0){var b=d.indexOf(c+"=");if(b!=-1){b=b+c.length+1;var a=d.indexOf(";",b);if(a==-1){a=d.length;}var e=d.substring(b,a);if(e){return decodeURIComponent(e);}}}return"";}};var config_e300={lp:["(.*html)","url","1"],image:['//*[@id="bu1"]',"xpath","src"],pname:["/([^/]+).html","url","1"]};pixel.initialize=function(){var a=document.URL.toLowerCase();pixel.paramArray.account_id="VIZVRM2277";pixel.paramArray.section="1";pixel.paramArray.level="1";if(pixel.getDataFromXPath("/html/body/div[4]/div[4]/div[1]/div[2]/p[1]","").toLowerCase().indexOf("service providers available")!==-1){pixel.paramArray.param="e100";}else{if(/\/vizury/.test(a)){pixel.paramArray.param="e400";if(window["$VAR1"]){pixel.paramArray.pid1=window["$VAR1"];}}else{if(/dir\.indiamart\.com\/indianexporters\//.test(a)||/dir\.indiamart\.com\/cgi\/catprdsearch\.mp\?/.test(a)){pixel.paramArray.param="e200";}else{if(typeof ims!=="undefined"&&ims.mcat_ids){pixel.paramArray.param="e300";pixel.pixelConfig=config_e300;}else{pixel.paramArray.param="e100";}}}}};pixel.finalize=function(){var d=document.URL.toLowerCase(),h="visit_count";var b="",f=pixel.getCookieValue(h);var c="",e=0,g="",a="";if(!f){b=0;}else{b=Number(f.split("|")[0]);}if(pixel.tyPage){pixel.paramArray=[];pixel.paramArray.account_id="VIZVRM2277";pixel.paramArray.section=pixel.paramArray.level="1";pixel.paramArray.param="e500";if(b>0){pixel.paramArray.level="2";}if(b){b++;f=b;pixel.set2DayCookie(h,f,30,false);}else{pixel.set2DayCookie(h,1,30,false);}}else{if(pixel.paramArray.param=="e300"){if(typeof ims!=="undefined"&&ims.mcat_ids&&ims.mcat_ids.length>0){pixel.paramArray.pid=ims.mcat_ids[0];}pixel.paramArray["new"]=pixel.paramArray.old=9999;if(/\/impcat\//.test(d)){pixel.paramArray.level="1";if(typeof grpID!=="undefined"&&grpID){pixel.paramArray.catid=grpID;}if(typeof catID!=="undefined"&&catID){pixel.paramArray.subcat1id=catID;}}else{if(/\/search/.test(d)){pixel.paramArray.level="2";pixel.paramArray.pname=pixel.getDataFromUrl(/[?#&]ss=([^&#]+)/,"1");}else{pixel.paramArray.level="3";}}if(!pixel.paramArray.image){pixel.paramArray.image=pixel.getDataFromXPath('//*[@id="i1"]',"src");}c=document.getElementsByTagName("p");for(e=0;e<c.length;e++){if(c[e].className=="sendEnquiry-container"){g=c[e].getElementsByTagName("a");if(g[0]&&g[0].getAttribute("onclick")){a=g[0].getAttribute("onclick");if(/ctg=\d+/.test(a)){pixel.paramArray.subcatid=a.match(/ctg=(\d+)/)[1];}if(/'grp':'(\d+)/.test(a)){pixel.paramArray.catid=a.match(/'grp':'(\d+)/)[1];}break;}}}}else{if(pixel.paramArray.param=="e200"){if(/dir\.indiamart\.com\/indianexporters\//.test(d)){pixel.paramArray.level="2";}c=document.getElementsByTagName("p");for(e=0;e<c.length;e++){if(c[e].className=="sendEnquiry-container"){g=c[e].getElementsByTagName("a");if(g[0]&&g[0].getAttribute("onclick")){a=g[0].getAttribute("onclick");if(/ctg=\d+/.test(a)){pixel.paramArray.subcatid=a.match(/ctg=(\d+)/)[1];}if(pixel.paramArray.level=="2"&&/'grp':'(\d+)/.test(a)){pixel.paramArray.catid=a.match(/'grp':'(\d+)/)[1];}break;}}}}}}pixel.fireAnalyze(pixel.getQueryString(pixel.paramArray));};
